local ChaCha20 = require("./ChaCha20")

local ctx = ChaCha20.newCtx({
	-- 16 numbers
	0x03020100,
	0x07060504,
	0x0b0a0908,
	0x0f0e0d0c,
	0x13121110,
	0x17161514,
	0x1b1a1918,
	0x1f1e1d1c,
}, {
	-- 3 numbers
	0x09000000,
	0x4a000000,
	0x00000000,
})

local myPassword = buffer.fromstring(
	"\068\134\142\135\180\027\056\053\052\110\164\051\131\069\007\161\181\168\212\163\082\185\068\035\098\077\216\186\183\188\009\110\162\227\023\050\039\174\156\041\109\167\182\119\170\167\034\235\149\122\253\167\187\054\061\218\164\165\241\141\198\112\072\038\111\168\234\025\077\178\205\032\157\184\140\214\133\089\153\179\235\051\177\237\138\070\116\147\194\211\032\191\122\071\250\139\130\001\151\244\117\190\173\231\209\085\002\239\027\017\111\207\052\128\147\073\237\060\072\103\119\038\135\086\047\244\192\075\180\214\209\162\226\146\069\227\088\176\176\119\142\060\038\080\116\025\250\250\012\164\254\053\024\151\048\241\144\104\078\107\226\166\125\252\162\078\138\123\244\019\061\171\219\164\083\045\083\168\186\059\010\034\114\113\060\207\222\128\041\053\128\090\001\181\237\104\019\019\025\185\176\009\019\042\141\218\103\125\037\142\127\197\161\063\097\094\113\050\026\051\205\126\233\069\092\022\255\202\190\030\252\055\082\230\187\232\118\108\058\192\060\194\046\190\161\158\144\066\169\093\026\179\019\002\099\248\193\120\219\199\208\248\138\098\092\021\246\125\114\191\115\214\029\169\060\008\109\021\231\119\018\054\023\014\117\035\133\255\144\168\200\102\087\098\176\043\150\076\151\143\195\211\210\044\069\019\183\159\075\232\235\152\170\116\020\220\138\106\119\248\119\070\080\224\039\079\080\222\202\156\168\073\076\021\057\108\057\079\014\037\023\198\048\092\212\184\234\037\180\061\098\176\037\200\163\099\105\101\232\002\179\251\232\190\063\113\097\068\253\119\196\101\029\255\049\200\249\105\243\124\216\062\068\024\234\171\202\127\036\169\226\195\100\109\241\165\144\109\215\203\250\028\216\235\159\123\103\127\062\106\191\040\199\096\184\189\196\218\109\243\171\008\232\185\093\181\064\252\220\181\050\190\059\195\079\075\051\075\152\076\081\042\178\242\121\057\106\229\004\069\187\197\203\165\087\044\040\136\118\057\211\255\103\110\092\224\146\143\047\067\000\039\243\090\032\031\120\110\071\123\234\202\193\233\240\022\140\048\204\221\202\254\145\235\169\190\206\038\034\102\145\096\102\234\173\000\096\237\135\004\204\246\067\031\170\201\080\022\150\184\202\002\190\022\138\148\029\119\023\008\071\194\036\000\180\006\224\046\236\022\148\015\084\032\199\005\133\063\181\081\142\099\162\084\062\014\195\208\239\112\130\085\186\004\050\058\091\094\229\132\105\028\049\105\238\167\039\071\238\192\190\093\136\225\194\206\073\028\095\016\109\132\037\019\243\099\067\098\201\115\089\096\235\019\250\101\000\048\091\050\094\015\206\174\092\071\225\219\016\201\021\128\089\034\103\008\073\058\035\004\051\115\222\069\227\021\159\008\029\253\145\250\060\100\240\160\046\179\021\027\011\136\027\246\028\006\098\079\189\252\143\251\008\018\155\087\101\210\180\180\056\198\189\082\210\135\195\103\059\097\113\197\130\163\219\118\225\156\228\043\009\224\235\114\171\145\066\060\194\087\064\085\015\093\001\086\143\182\001\065\098\219\027\004\057\241\206\232\020\083\132\085\128\195\114\188\068\238\121\254\107\054\025\118\181\061\160\157\254\201\020\190\064\159\143\023\168\115\052\229\076\198\133\112\167\074\224\115\225\086\249\125\065\247\074\218\230\078\186\070\179\049\068\146\201\210\118\191\227\108\166\234\242\065\090\119\069\052\042\014\034\101\246\101\007\143\044\143\113\141\003\253\115\157\007\073\186\240\112\115\198\161\242\118\037\042\222\148\047\158\074\076\180\003\071\019\141\193\204\071\099\028\107\220\158\211\186\188\104\205"
)

ChaCha20.genBlock(ctx)
ChaCha20.xorBuffer(ctx, myPassword)

print(buffer.tostring(myPassword))

-- (ง ͠° ͟ʖ ͡°)ง
ChaCha20.genBlock(ctx)
ChaCha20.xorBuffer(ctx, myPassword)
